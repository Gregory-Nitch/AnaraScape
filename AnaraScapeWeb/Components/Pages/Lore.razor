@page "/lore/{table?}/{id:int?}"

@using AnaraScapeWeb.Components.Layout

@rendermode InteractiveServer

@inject NavigationManager NavManager

<PageTitle>Lore</PageTitle>

<LoreSideBar /> @* Keep outside of article for proper positioning. *@

<article>

    <LoreSearchBar />

    @if (Table != null && Id != null)
    {
        @switch (Table.ToLower())
        {
            case "artifacts":
                <ArtifactLore OnReqLoreEvent="GoToLore" Id="(int)Id" />
                break;

            case "events":
                <EventLore OnReqLoreEvent="GoToLore" Id="(int)Id" />
                break;

            case "factions":
                <FactionLore OnReqLoreEvent="GoToLore" Id="(int)Id" />
                break;

            case "historical-ages":
                <HistoricalAgeLore OnReqLoreEvent="GoToLore" Id="(int)Id" />
                break;

            case "npcs":
                <NPCLore OnReqLoreEvent="GoToLore" Id="(int)Id" />
                break;

            case "locations":
                <LocationLore OnReqLoreEvent="GoToLore" OnReqMapEvent="GoToMap" Id="(int)Id" />
                break;

            case "resources":
                <ResourceLore Id="(int)Id" />
                break;

            case "terminologies":
                <TerminologyLore Id="(int)Id" />
                break;

            default:
                break; // TODO log and recover, go to main lore page/error?
        }
    }
    else
    {
        // TODO show default top lore info
    }

</article>

@code {
    [Parameter]
    public string? Table { get; set; }
    [Parameter]
    public int? Id { get; set; }

    public void GoToLore((string table, int id) req)
    {
        NavManager.NavigateTo($"/lore/{req.table}/{req.id}");
    }

    public void GoToMap(string mapName)
    {
        NavManager.NavigateTo($"/world-maps/{mapName}");
    }
}
